wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: takonoselidze (takonoselidze-charles-university). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.3
wandb: Run data is saved locally in /scratch.ssd/takonoselidze/job_5547071.pbs-m1.metacentrum.cz/wandb/run-20241023_004358-enh0gci9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earnest-tree-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/takonoselidze-charles-university/Cleverhans%20Sl1D-resnet50
wandb: üöÄ View run at https://wandb.ai/takonoselidze-charles-university/Cleverhans%20Sl1D-resnet50/runs/enh0gci9
Traceback (most recent call last):
  File "main.py", line 220, in <module>
    adv_images, original_preds, adv_preds = attack(attack_name, attack_params, model, dataloader, brightness_factor, device)
  File "main.py", line 124, in attack
    adversarial_image = attack_name(model, image, **attack_params).detach().to(device)
  File "/usr/local/lib/python3.8/dist-packages/cleverhans/torch/attacks/sparse_l1_descent.py", line 99, in sparse_l1_descent
    assert np.all(asserts)
  File "<__array_function__ internals>", line 200, in all
  File "/usr/local/lib/python3.8/dist-packages/numpy/core/fromnumeric.py", line 2515, in all
    return _wrapreduction(a, np.logical_and, 'all', axis, None, out,
  File "/usr/local/lib/python3.8/dist-packages/numpy/core/fromnumeric.py", line 86, in _wrapreduction
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/_tensor.py", line 970, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
